(this["webpackJsonpsc-coding-challenge"]=this["webpackJsonpsc-coding-challenge"]||[]).push([[0],{112:function(e,t,a){e.exports=a(154)},117:function(e,t,a){},123:function(e,t,a){},149:function(e,t,a){},150:function(e,t,a){},151:function(e,t,a){},152:function(e,t,a){},154:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(4),s=a.n(c),o=(a(117),a(20)),i=a(5),u=a.n(i),l=a(10),p=a(13),E=Object.freeze({INITIAL:"FETCH_TOPICS_INITIAL",SUCCESS:"FETCH_TOPICS_SUCCESS",FAILURE:"FETCH_TOPICS_FAILURE"}),m=Object.freeze({INITIAL:"FETCH_POSTS_INITIAL",SUCCESS:"FETCH_POSTS_SUCCESS",FAILURE:"FETCH_POSTS_FAILURE"}),d=Object.freeze({INITIAL:"SEARCH_TOPICS_INITIAL",SUCCESS:"SEARCH_TOPICS_SUCCESS",FAILURE:"SEARCH_TOPICS_FAILURE"}),f=Object.freeze({SET_ERROR:"APP_SET_ERROR",SET_SHOWING_POSTS:"APP_SET_SHOWING_POSTS",SET_CURRENT_TOPIC:"APP_SET_CURRENT_TOPIC"});function h(e){return S.apply(this,arguments)}function S(){return(S=Object(l.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t);case 3:return a=e.sent,e.next=6,a.json();case 6:return e.abrupt("return",e.sent);case 9:throw e.prev=9,e.t0=e.catch(0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function v(e){return h("https://www.reddit.com/r/".concat(e,"/hot.json"))}function b(e,t){return t=t.data.children.map((function(e){return e.data})),{type:m.SUCCESS,topic:e,data:t}}function O(e){var t=e.data.children.map((function(e){return e.data}));return{type:E.SUCCESS,topics:t}}function I(e){var t=e.data.children.map((function(e){return e.data}));return{type:d.SUCCESS,topics:t}}function T(e){return{type:f.SET_ERROR,err:e}}function C(e){return{type:f.SET_SHOWING_POSTS,isShowingPosts:e}}function _(e){return function(){var t=Object(l.a)(u.a.mark((function t(a){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a({type:m.INITIAL}),t.prev=1,t.next=4,v(e);case 4:r=t.sent,a(b(e,r)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),a((n=t.t0,{type:m.FAILURE,err:n}));case 11:case"end":return t.stop()}var n}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}()}var g=a(42),y=a(43),j=a(51),w=a(44),N=a(52),R=a(156),P=a(15),k=a(11),A=(a(123),function(e){function t(e){var a;return Object(g.a)(this,t),(a=Object(j.a)(this,Object(w.a)(t).call(this,e))).state={hasError:!1},a}return Object(N.a)(t,e),Object(y.a)(t,[{key:"componentDidCatch",value:function(e,t){this.props.dispatch(T({error:e,errorInfo:t}))}},{key:"render",value:function(){return this.state.hasError||this.props.hasError?n.a.createElement("main",{className:"error-boundary"},n.a.createElement("div",{className:"message"},n.a.createElement(R.a,{icon:k.a.ERROR,intent:P.a.DANGER}),n.a.createElement("h1",null,"Sorry, something went wrong."),n.a.createElement("h2",null,"Please try again later."))):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),t}(n.a.Component));function U(e){return e.length?e.slice(0,1).toUpperCase()+e.slice(1):e}function L(e){return e.split("_").map(U).join(" ").trim()}a(149);function x(e){var t=e.data,a=e.dispatch,r=t.display_name_prefixed,c=t.title,s=t.display_name;var o=function(e){var t=e.icon_img;if(t){var a={backgroundImage:"url(".concat(t,")")};return n.a.createElement("div",{className:"topic-icon",style:a})}return null}(t),i=function(e){var t=e.banner_background_image,a=e.banner_background_color,r=e.header_img,c={};return r?(c.backgroundImage="url(".concat(r,")"),c.backgroundSize="contain"):t&&(c.backgroundImage="url(".concat(t,")"),c.backgroundSize="cover"),a&&(c.backgroundColor=a),n.a.createElement("div",{className:"banner",style:c})}(t);return n.a.createElement("div",{className:"topic",onClick:function(){var e;a((e=s,{type:f.SET_CURRENT_TOPIC,topic:e})),a(C(!0))}},i,n.a.createElement("div",{className:"description"},n.a.createElement("div",{className:"title"},c),n.a.createElement("div",{className:"author"},o,n.a.createElement("div",{className:"display-name-prefixed"},r))))}var F=function(e){var t=e.topics,a=e.displayTitle,r=e.dispatch,c=t.map((function(e){return n.a.createElement(x,{data:e,key:e.name,dispatch:r})}));return a=L(a),n.a.createElement(n.a.Fragment,null,n.a.createElement("h1",null,a," Topics"),n.a.createElement("div",{className:"topics"},c))};a(150);function H(e){var t=e.data,a=t.title,r=t.url,c=t.created,s=t.author,o=t.ups,i=function(e,t){var a,r=[[60,"second"],[3600,"minute"],[86400,"hour"],[604800,"day"],[2592e3,"week"],[31557600,"month"]],n=Math.abs(e-t)/1e3+1,c=r.map((function(e,t){return{entry:e,i:t}})).filter((function(e){var t=Object(p.a)(e.entry,2),a=t[0];t[1];return n<a})),s=n;if(c.length){var o=c.shift(),i=Object(p.a)(o.entry,2),u=(i[0],i[1]),l=o.i;a=u,l>0&&(s=n/r[l-1][0])}else s=n/31557600,a="year";return s=Math.floor(s),"".concat(s," ").concat(a).concat(s>1?"s":"")}(1e3*c,+new Date);var u=function(e){var t=e.thumbnail;return t&&RegExp("http*","gi").test(t)?n.a.createElement("div",{className:"thumbnail",style:{backgroundImage:"url(".concat(t,")")}}):null}(t);return n.a.createElement("a",{href:r,target:"_blank"},n.a.createElement("div",{className:"post"},u,n.a.createElement("div",{className:"text"},n.a.createElement("h1",{className:"title"},a),n.a.createElement("div",{className:"user-metadata"},"Posted by ".concat(s," ").concat(i," ago")),n.a.createElement("div",{className:"ups"},n.a.createElement(R.a,{icon:k.a.THUMBS_UP}),n.a.createElement("div",{className:"amount"},o.toLocaleString()||0)))))}var D=function(e){var t=e.posts,a=e.topic,r=e.dispatch;window.scrollTo(0,0);var c=t.map((function(e){return n.a.createElement(H,{data:e,key:e.name})})),s=function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(C(!1));case 2:window.scrollTo(0,0);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return n.a.createElement(n.a.Fragment,null,n.a.createElement("h1",null,L(a)),n.a.createElement("div",{className:"posts"},n.a.createElement("nav",null,n.a.createElement("span",{className:"back-icon",onClick:s},n.a.createElement(R.a,{icon:k.a.CHEVRON_LEFT}))),c))};a(151);var z=function(e){var t=e.setInputVal,a=e.handleOnKeyDown,c=e.firstSearch,s=e.dispatch,o=Object(r.useRef)(null),i=Object(r.useState)("Search a subreddit"),u=Object(p.a)(i,2),l=u[0],E=u[1],m=Object(r.useState)(""),d=Object(p.a)(m,2),f=d[0],h=d[1],S=Object(r.useRef)(null),v=function(){try{h(""),o.current.focus()}catch(e){s(T(e))}};return n.a.createElement("div",{className:"search-container",style:{width:c?"50%":"80%"},ref:S},n.a.createElement(R.a,{className:"search-btn",icon:k.a.SEARCH}),f?n.a.createElement("span",{onClick:v},n.a.createElement(R.a,{className:"close-btn",icon:k.a.SMALL_CROSS})):null,n.a.createElement("input",{type:"text",value:f,spellCheck:!1,onChange:function(e){try{t(e.target.value),h(e.target.value),e.target.value||E("Search a subreddit")}catch(a){s(T(a))}},onKeyDown:a,placeholder:l,ref:o}))};a(152);var M=Object(o.b)((function(e){return{appState:e.app}}))((function(e){var t=e.appState,a=e.dispatch,c=t.hasError,s=t.topics,o=t.currentTopic,i=t.isShowingPosts,m=t.posts,f=Object(r.useState)(!0),S=Object(p.a)(f,2),v=S[0],b=S[1],T=Object(r.useState)(""),g=Object(p.a)(T,2),y=g[0],j=g[1];Object(r.useEffect)((function(){w()}),[]),Object(r.useEffect)((function(){(function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m.has(o)){e.next=3;break}return e.next=3,a(_(o));case 3:window.scrollTo(0,0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()().then()}),[o]);var w=function(){a(function(){var e=Object(l.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t({type:E.INITIAL}),e.prev=1,e.next=4,h("https://www.reddit.com/subreddits/popular.json?raw_json=1");case 4:a=e.sent,t(O(a)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),t((r=e.t0,{type:E.FAILURE,err:r}));case 11:case"end":return e.stop()}var r}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}()),b(!0),a(C(!1))},N=function(e){var t;a((t=e,function(){var e=Object(l.a)(u.a.mark((function e(a){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a({type:d.INITIAL}),e.prev=1,e.next=4,h("https://www.reddit.com/subreddits/search.json?q=".concat(t));case 4:r=e.sent,a(I(r)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),a((n=e.t0,{type:d.FAILURE,err:n}));case 11:case"end":return e.stop()}var n}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}())),b(!1),a(C(!1))},R=Object(r.useMemo)((function(){var e=v?"Popular":y;return i&&o&&m.has(o)?n.a.createElement(D,{posts:m.get(o),topic:o,dispatch:a}):n.a.createElement(F,{topics:s,dispatch:a,displayTitle:e})}),[s,m,i]),P={handleOnKeyDown:function(e){var t=e.keyCode;try{var a=e.target.value;13===t&&(a?N(a):w())}catch(e){console.log(e)}},firstSearch:!0,dispatch:a,setInputVal:j};return n.a.createElement(A,{hasError:c,dispatch:a},n.a.createElement("main",{className:"app"},n.a.createElement(z,P),R))})),G=a(17),W=a(48),K=a.n(W),V=a(49),B=a(14),J=a(50),q={topics:[],posts:new Map,isShowingPosts:!1,currentTopic:null,inProgress:!1,error:null,hasError:!1};function Q(e,t,a){var r=Object(J.cloneDeep)(e);return r.set(t,a),r}var X=Object(G.c)({app:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0,a=e.posts;switch(t.type){case m.INITIAL:case E.INITIAL:case d.INITIAL:return Object(B.a)({},e,{error:null,inProgress:!0,hasError:!1});case m.SUCCESS:return Object(B.a)({},e,{inProgress:!1,posts:Q(a,t.topic,t.data)});case E.SUCCESS:case d.SUCCESS:return Object(B.a)({},e,{inProgress:!1,topics:t.topics});case m.FAILURE:case E.FAILURE:case d.FAILURE:return Object(B.a)({},e,{inProgress:!1,error:t.err,hasError:!0});case f.SET_ERROR:return Object(B.a)({},e,{hasError:!0,error:t.err});case f.SET_SHOWING_POSTS:return Object(B.a)({},e,{isShowingPosts:t.isShowingPosts});case f.SET_CURRENT_TOPIC:return Object(B.a)({},e,{currentTopic:t.topic});default:return e}}}),Y=Object(G.a)(K.a,V.a),Z=Object(G.d)(X,Y);s.a.render(n.a.createElement(o.a,{store:Z},n.a.createElement(M,null)),document.getElementById("root"))}},[[112,1,2]]]);
//# sourceMappingURL=main.e7039e33.chunk.js.map